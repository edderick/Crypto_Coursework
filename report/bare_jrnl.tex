\documentclass[12pt,a4paper,twoside]{article}
%\documentclass[journal]{IEEEtran}

\usepackage{paralist}
\usepackage[stable]{footmisc}
\hyphenation{op-tical net-works semi-conduc-tor}

\usepackage[top=2.4cm, bottom=2.4cm, left=2.95cm, right=2.95cm]{geometry} 

\usepackage{listings}
\lstset{basicstyle=\ttfamily, escapechar=\â‚¬}

\usepackage{color}
\usepackage{setspace}

\usepackage{amsmath}

\definecolor{Code}{rgb}{0,0,0}
\definecolor{Decorators}{rgb}{0.5,0.5,0.5}
\definecolor{Numbers}{rgb}{0.5,0,0}
\definecolor{MatchingBrackets}{rgb}{0.25,0.5,0.5}
\definecolor{Keywords}{rgb}{0,0,1}
\definecolor{self}{rgb}{0,0,0}
\definecolor{Strings}{rgb}{0,0.63,0}
\definecolor{Comments}{rgb}{0,0.63,1}
\definecolor{Backquotes}{rgb}{0,0,0}
\definecolor{Classname}{rgb}{0,0,0}
\definecolor{FunctionName}{rgb}{0,0,0}
\definecolor{Operators}{rgb}{0,0,0}
\definecolor{Background}{rgb}{0.98,0.98,0.98}

\lstnewenvironment{python}[1][]{
\lstset{
numbers=left,
numberstyle=\footnotesize,
numbersep=1em,
xleftmargin=1em,
framextopmargin=2em,
framexbottommargin=2em,
showspaces=false,
showtabs=false,
showstringspaces=false,
frame=l,
tabsize=4,
% Basic
basicstyle=\ttfamily\small\setstretch{1},
backgroundcolor=\color{Background},
language=Python,
% Comments
commentstyle=\color{Comments}\slshape,
% Strings
stringstyle=\color{Strings},
morecomment=[s][\color{Strings}]{"""}{"""},
morecomment=[s][\color{Strings}]{'''}{'''},
% keywords
morekeywords={import,from,class,def,for,while,if,is,in,elif,else,not,and,or,print,break,continue,return,True,False,None,access,as,,del,except,exec,finally,global,import,lambda,pass,print,raise,try,assert},
keywordstyle={\color{Keywords}\bfseries},
% additional keywords
morekeywords={[2]@invariant},
keywordstyle={[2]\color{Decorators}\slshape},
emph={self},
emphstyle={\color{self}\slshape},
%
}}{}



\begin{document}

\title{Cryptography: Secrecy Through Numbers}
\author{Edward~JF~Seabrook}

\maketitle

\section{Ellitic Curves}
This question has been divided into four parts, labeled A through D.

\subsection{Part a}
The order of my group is twenty four. 

\subsection{Part b}
Yes, of course it is. 

\subsection{Part c}
Elliptic curves have the interesting property of that any two points on the
lien will intersect the line again at another point. This can be used as a
group operator, and used to generate a group. For some reason this new group
can be nice and secure.  

\subsection{Part d}
Answer here. 


\section{Vigenere Cipher}
We were given the following message, and told to decrypt it:


\begin{lstlisting}
qhc jeqpaeb srxrrp hcoe pbccktjv hyoduxrc qrmgalp hyse
yqtpxcrbd ree yqtcktgln mc gmsepkmcktq xnb oeqbapzhcos mke mc
tfb myfn alnabrlp iq qhyq ilqeeoarbd afrarirp il jijftyoy mo
cpftgzaj fndoaqqrsztsoe ympjfcyqimks aluja bc jajfcgluqiy
kxngmujxtca dsoild tfb mykudxcrrrgkg nooabsq thgzh mctck tyheq
mlyze yyrmxd flwcsep pilze reepb hyse zbel ko pbpmotca
hyoduxrc qrmgalp il mryztgze wbt jftrie gp kllwl xbmrt flw
qrcf x tpljyk wmrlb iomh lghe ykd flw fxrb qo gjpjbmckt mke gk
ppxcrfcc lnc bxyjpjb iq aonxnr qrmgal qhgp cyk bc rsca tm
zokmrmjiqb tfb sczupftw lf y jeykildfsi rcxl ulrja tyogcq
wfflc xvmfdgkg bbtcztgln zv fskcrfolxl rbsrfne xs ublj xs
roohxn bbtcztgln kbcfxngpmq puae tpljyks axn zb uqbd rl
eqqaziiqe a ffdbbn qfdc zhyknci il xn mqhcowgpe qfdc zhyknci
rcpiqqalq dcpiek tffs roohxn bleq kor zhykgc qhc ioefc txlsb
od xnw darb bsq ilptcxd aealdeq lnjv tfb pmtep mrmcijb od qwm
darbs yk etxlsxtmo wfl iq kor xwyoe mc tfb tpljyk cyknmq
arqaah tfb tpljyk dcpiek uqfne zokjol pibb cfxnlbl yqtyzkq qhc
lwlbr mc tfb tpljyk hmtetbr axn spe ffs ikouiebde mc tfb
tpljyk pmtep jobbl rl eqqaziiqe a ffdbbn qfdc zhyknci tfxt
pblgxbjv lcxkq lur peaoer hewp tffs gp tfb ela od qhc jeqpaeb 
\end{lstlisting}

My initial guess was that this cipher was a monoalphabetic substitution cipher,
since the ciphertext appears to have spaces in roughly the correct places. 

I began solving this cipher by calculating the Index of Coincidence (IC) for
the text. I was dissapointed to obtain a value of 1.128, which is quite
different from the IC for English of 1.73. This means that the cipher used is
not a simple monoalphabetic substitution. 

I then attempted to iterate through different strides (number of letters to
skip when sampling), to see if the cipher used was dependent on the position in
the text. A stride of 2 did not produce a better result, yielding 1.126 and
1.129 starting from character 0 and 1 respectively.  

Fortunately, using a stride of 3 returned a much better set of values: 1.844,
1.759 and 1.80; for starting character positions of 0, 1 and 2 respectively.
Although this is not exactly equal the expected values for English, I felt that
for the size of the messages (total length of the message divided by three),
they indicated that it was worth investigating.  

Given that the substitution was a poly-alphabetic substitution with stride of
three, I began by treating the cipher as a Viginere cipher. On inspection, the
triad 'qhc' jumped out at me as a repeating pattern. Due to the commonness of
the word, I figured that the word could be `the'. If this was correct, then the
Viginere key would be 'xay', resulting in a shifts of 23, 0 and 2.

Using the following python code, I generated the answer to the question:

\begin{python}
import string

def shift(c, key):
    n = ord(c) - ord('a')
    k = ord(key) - ord('a')
    return chr((n - k) % 26 + ord('a'))

key = "xay"
answer = ""

with open('ciphertext.txt'):
    n = 0
    for c in s:
        if c in string.ascii_lowercase:
            answer += shift(c, key[n%len(key)])
            n += 1
        else:
            answer += c
        
print answer
\end{python}

The answer that I obtained was: 

\begin{lstlisting}
the message starts here recently hardware trojans have
attracted the attention of governments and researchers one
of the main concerns is that integrated circuits in military
or critical infrastructure applications could be maliciously
manipulated during the manufacturing process which often
takes place abroad however since there have been no reported
hardware trojans in practice yet little is known about how
such a trojan would look like and how hard to implement one
in practice one example is dopant trojan this can be used to
compromise the security of a meaningful real world target
while avoiding detection by functional testing as well as
trojan detection mechanisms such trojans can be used to
establish a hidden side channel in an otherwise side channel
resistant design this trojan does not change the logic value
of any gate but instead changes only the power profile of
two gates an evaluator who is not aware of the trojan cannot
attack the trojan design using common side channel attacks
the owner of the trojan however can use his knowledge of the
trojan power model to establish a hidden side channel that
reliably leaks out secret keys this is the end of the
message
\end{lstlisting}
 
\section{Two Part Encryption}
The file ``secret.hex'' contained a secret message. The message had been
encyrpted in two stages, the first stage was unknown, and the second stage was
a simple XOR based cipher. We were given the first two characters of the
intermediate text --`Hg'.

To decrypt the message, the two stages had to be performed in reverse order:
first the XOR stage, followed by the unknown cipher stage. 

I began by creating a python script that first reads in the secret message, and
then retrieves the key for the known portion of the message. Given that we only
had two letters of the intermediate text, I guessed that the key length of the
message is two, and repreated the key that I had retrieved for the length of
the message to retrieve some text. The Python code that I used to decode the
message into it's intermediate form is as follows:

\begin{python}
with open("secret.hex") as f:
    ciphertext = f.read()

    k1 = chr(ord(ciphertext[0:1]) ^ ord("H"))
    k2 = chr(ord(ciphertext[1:2]) ^ ord("g"))
    keystream = (k1 + k2) * (len(ciphertext) / 2)

    plaintext = "".join(
            [chr(ord(k) ^ ord(c)) 
             for k, c in zip(keystream, ciphertext)]
    )

    print plaintext
\end{python}

This resulted in the followin intermediate text: 

\begin{lstlisting}
Hgt ltsbuba pm dumt uy hgt lpyh wqpmpxbr sbr tdxyuct lvyhtqv
pm hgtl sdd, xbobpib hp tctb hgt aqtshtyh lubry.  Yxqtdv
sbvpbt igp htddy vpx hgtv gsct hgt sbyitq uy npouba, lsr pq
yulwdv luyhsotb.  Hgtqt sqt lsbv hgubay hgsh lsot dumt ipqhg
gpdruba pb hp sbr yscpxquba. Exh dumt uy xbwqtrukhsedt sbr it
sqt pmhtb lvyhtquty tctb hp pxqytdcty.  It hgubo yxkktyy,
gswwubtyy, gtdwuba phgtqy, pq yxqwsyyuba pxqytdcty iudd lsot
dumt ipqhg ducuba, exh it ksb sdisvy et iqpba pq mqxyhqshtr ev
tctbhy. Hguy uy s qsbrpl wgqsyt.  Wgudpypwgtqy gsct s dph hp
ysv sepxh hgt csdxt pm sdd hgtyt hgubay, sbr s duhhdt dtyy hp
ysv sepxh pbt pm hgt lpyh csdxsedt hgubay pm sdd: dpct. Yp it
ksb et kdtsq tbpxag sepxh igsh uh ltsby mpq dumt hp gsct
ltsbuba sbr csdxt, exh igtb it wxh rpib pxq wgudpypwgv eppoy
sbr skhxsddv ath pb iuhg ducuba, ltsbuba sbr csdxt ksb et
tdxyuct. Ducuba itdd uy lpqt sqh hgsb ykutbkt pq wgudpypwgv.
Hgtqtmpqt,  hgt pbdv ytbyt it ksb lsot pm hgt urts hgsh dumt
gsy ltsbuba uy hgsh hgtqt sqt yplt qtsypby hp duct qshgtq hgsb
hp rut, sbr hgpyt qtsypby sqt hp et mpxbr ub hgt ducuba pm
dumt uhytdm.
\end{lstlisting}

By simple inspection, this looked like it was likely to be the output of a
basic cipher -- the message contains only alphabetic characters, and there are
spaces evenly distributed throughout the text. Although this could have just
been by chance, it definitely looked like a good lead to follow.

As I believed this text looked like natrual language, I decided the next step was
to calculate the Index of Coincidence (IC) for this text. The IC is a weighted
sum of the frequency of the letters, and can be used to identify if a
ciphertext has the same frequency distribution as a given language. If it has
the same distribution, then the cipher is a simple substitution cipher. The IC
is calculated as:

$$
\textup{IC} =  \frac{\sum_{i=1}^{c} n_i(n_i -1)}{N(N - 1)/c}
$$

Where $N$ is the length of the text. $n_1$ to $n_c$ are the counts
for each of the possible characters. And $c$ is the number of
letters in the alphabet. 

To calculate the IC, I used the following python script. 
\begin{python}
from __future__ import division
import string

with open("intermediate.txt") as f: 
    s = f.read()

    freq = {}

    for c in string.ascii_uppercase:
        freq[c.upper()] = 0

    for c in s:
        if c.upper() in string.ascii_uppercase:
            freq[c.upper()] += 1
                           
    N = sum([n for n in freq.values()])
    c = len(string.ascii_uppercase)

    numerator = sum([(n * (n-1)) for n in freq.values()]) 
    denominator = ((N * (N-1))/c)

    IC = numerator / denominator 

    print IC
\end{python}

The value calculated for the IC was ``1.7086'', which is very close to that of
the English language (1.73). This finding confirmed my belief that the cipher
used was some form of monoalphabetic substitution.  

By copying the intermediate text into {\tt vim}, and using the search and
replace functionality (s/x/Y/g), I began substituting letters with likely
substitutions. I started basing my substitions on the frequencies of the
letters; i.e. beginning by replacing `t' ,the most common letter in the text,
with `E', the most common letter in English. Once I had replaced a few letters,
it became obvious what words in the text could potentially be, so I based my
substitutions on this. 

Eventually, I managed to obtain the following message. As the message, makes
sense to me in English, I am confident that this passage is the correct
plaintext. 

\begin{lstlisting}
THE MEANING OF LIFE IS THE MOST PROFOUND AND ELUSIVE MYSTERY
OF THEM ALL, UNKNOWN TO EVEN THE GREATEST MINDS. SURELY
ANYONE WHO TELLS YOU THEY HAVE THE ANSWER IS JOKING, MAD OR
SIMPLY MISTAKEN.  THERE ARE MANY THINGS THAT MAKE LIFE WORTH
HOLDING ON TO AND SAVOURING. BUT LIFE IS UNPREDICTABLE AND
WE ARE OFTEN MYSTERIES EVEN TO OURSELVES. WE THINK SUCCESS,
HAPPINESS, HELPING OTHERS, OR SURPASSING OURSELVES WILL MAKE
LIFE WORTH LIVING, BUT WE CAN ALWAYS BE WRONG OR FRUSTRATED
BY EVENTS.  THIS IS A RANDOM PHRASE.  PHILOSOPHERS HAVE A
LOT TO SAY ABOUT THE VALUE OF ALL THESE THINGS, AND A LITTLE
LESS TO SAY ABOUT ONE OF THE MOST VALUABLE THINGS OF ALL:
LOVE. SO WE CAN BE CLEAR ENOUGH ABOUT WHAT IT MEANS FOR LIFE
TO HAVE MEANING AND VALUE, BUT WHEN WE PUT DOWN OUR
PHILOSOPHY BOOKS AND ACTUALLY GET ON WITH LIVING, MEANING
AND VALUE CAN BE ELUSIVE. LIVING WELL IS MORE ART THAN
SCIENCE OR PHILOSOPHY. THEREFORE,  THE ONLY SENSE WE CAN
MAKE OF THE IDEA THAT LIFE HAS MEANING IS THAT THERE ARE
SOME REASONS TO LIVE RATHER THAN TO DIE, AND THOSE REASONS
ARE TO BE FOUND IN THE LIVING OF LIFE ITSELF.
\end{lstlisting}


\section{Headline Puzzles}
The headline puzzles.

I started by trying to decode at least one of the messages. I started by
picking a long word, and trying to find a match for this word based on the
pattern of the letters. 

I wrote this python script to check the pattern of a letters words against an
UK English language dictionary that I downloaded from
http://www.karamasoft.com/ultimatespell/dictionary.aspx. This dictionary file
contained 126,850 words. 

\begin{python}
import string 

IN_WORD = "ERYHURBRWCVRPW"

with open("en-GB.dic") as word_list:
    dictionary = word_list.read().split("\r\n")

def pattern(s):
    seen = {}
    out = ""
    x = 'a'
    for c in s:
        if c in seen.keys():
            out += seen[c]
        else:
            out += x
            seen[c] = x
            x = chr(ord(x)+1)

    return out

pattern_dict = [pattern(w) for w in dictionary]

for i, p in enumerate(pattern_dict):
    if p == pattern(IN_WORD.lower()):
        print dictionary[i]

\end{python}

Using this script to find possible matches for ``ERYHURBRWCVRP'' returned only
one result, ``discrimination''. From here, many of the letters in this puzzle
could already be determined. 



% references section

% can use a bibliography generated by BibTeX as a .bbl file
% BibTeX documentation can be easily obtained at:
% http://www.ctan.org/tex-archive/biblio/bibtex/contrib/doc/
% The IEEEtran BibTeX style support page is at:
% http://www.michaelshell.org/tex/ieeetran/bibtex/
%\bibliographystyle{IEEEtran}
% argument is your BibTeX string definitions and bibliography database(s)
%\bibliography{IEEEabrv,../bib/paper}
%
% <OR> manually copy in the resultant .bbl file
% set second argument of \begin to the number of references
% (used to reserve space for the reference number labels box)
%\begin{thebibliography}{1}
%\end{thebibliography}


%\vfill

% that's all folks
\end{document}
